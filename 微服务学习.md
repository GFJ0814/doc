微服务学习

### 系统架构演进：

​	**单一架构**：一个tomcat就可以搞定一切，一台虚拟机可以跑起来，基础的MVC开发模式

​	暴露问题：随着用户访问量不断增大

​	<u>*1.维护成本高*</u>：应用是一个整体，问题修复，牵一发动全身，不理解整体业务以及设计情况下，修复问题以及排查问题不容易。

​	*2.可伸缩性差*，只能垂直扩展，难以水平扩展。

> ​	垂直扩展：提升单机处理能力，比如升级单机的CPU核数，网卡；比如使用缓存减少IO，异步服务增加单服务的吞吐量，使用无锁数据结构来减少响应时间。
>
> ​	优点：简单粗暴，性能提升快。适合创业早期，强烈建议使用“增强单机硬件性能”的方式提升系统并发能力，因为这个阶段，公司的战略往往是发展业务抢时间，而“增强单机硬件性能”往往是最快的方法。
>
> ​	缺点：单机性能总是有极限的
>
> 水平扩展：只要增加服务器数量，就能线性扩充系统性能。
>
> ​	特点：对整个系统的架构有要求，现在互联网的常见且是有效的方式。使用分层水平扩展架构来提升性能，包括反向代理层、站点层、服务层、数据层的水平扩展。都有一套方法论。
>
> 参考：<https://www.jianshu.com/p/be66a52d2b9b>

​	*3.交付周期长*。改动一处，需要编译整体代码，回归验证等。

​	*4.新人培养周期长*。随着应用的复杂度不断上升，新人对业务背景、环境搭建、程序熟悉都会花费更多的时间去完成。

**垂直应用架构：（第二代架构）**

分布式+集群

应用拆成独立模块部署，

怎么解决session问题，因为同一个用户，如果负载均衡策略是随机的话，这样就会导致用户再来的请求到另外一台机器，没有session信息，这样就会让用户退出登录。

解决办法：按照cookie负载均衡，就是将同一个用户第一次请求服务器的时候，服务器下发cookie，之后，下次请求的时候带上cookie，负载均衡，将该请求打到之前请求过的那台机器。（保证同一客户端访问同一台机器）

问题：第一次来的时候没有cookie吗？这样是不是随机的，然后第二次，按照cookie去打到第一台机器，也就是问题是cookie是在负载均衡之前生成，还是之后请求到服务生成？？？

对于缺陷问题的理解：

**微服务架构：（第三代架构）**

<http://dockone.io/article/2741>

<https://dbaplus.cn/news-141-1993-1.html>

